{% extends "base.html.j2" %}
{% block title %}index{% endblock %}
{% block head %}
    {{ super() }}
{% endblock %}
{% block content %}
    <form action="/search/post" method="POST">
        <div>search users (leave empty to list all): <input type="text" name="search"></div>
    </form>
    <h1>index</h1>
    {% if username %}
        <div>hello {{ username }}</div>
        <form action="/thread/post" method="POST">
            <div>start thread: <input type="text" name="message"></div>
        </form>
        <div id="userthreads">
        <h2>your threads</h2>
            {% for thread in threads %}
                <div><a href="/user/me">{{ thread.username }}</a>, <a href="/thread/{{ thread.thread_id }}"><time datetime="{{ thread.created_at }}"></time></a></div> </div>{{ thread.message }}</div>
            {% endfor %}
        </div>
        {% if watched %}
            <div id="watched-user-threads">
                <h2>others</h2>
                {% for thread in watched %}
                    <div><a href="/user/{{ thread.id }}">{{ thread.username }}</a>, <a href="/thread/{{ thread.thread_id }}"><time datetime="{{ thread.created_at }}"></time></a></div></div>{{ thread.message }}</div>
                {% endfor %}
            </div>
        {% else %}
            <div id="watched-user-threads">
                <h2>you're not following anyone :(</h2>
            </div>
        {% endif %}
    {% else %}
        <div>you're not logged in :|</div>
        <div>go to <a href="/login">login page</a> or <a href="/register">register</a></div>
    {% endif %}
{% endblock %}